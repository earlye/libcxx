
#===-------------------------------------------------------------------------------------------===//
# llvm-gitlab-runner-service - The image used to run gitlab-runner workers
#===-------------------------------------------------------------------------------------------===//
FROM ericwf/builder-base:latest AS llvm-gitlab-runner-service

RUN apt-get update && \
    apt-get install -y --no-install-recommends \
    bash-completion \
    vim \
    sudo \
    apt-utils \
  && rm -rf /var/lib/apt/lists/*

# Install Docker (used by gitlab runner)
RUN curl -sSL https://get.docker.com/ | sh

# Install gitlab runner
ADD scripts/install_gitlab_runner.sh /tmp/install_gitlab_runner.sh
RUN /tmp/install_gitlab_runner.sh && rm /tmp/install_gitlab_runner.sh

ADD gitlab/config.toml /etc/gitlab-runner/config.toml
ADD gitlab/config.toml $HOME/.gitlab-runner/config.toml
