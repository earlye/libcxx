# -*- Python -*- vim: set syntax=python tabstop=4 expandtab cc=80:

# Configuration file for the 'lit' test runner.


import os

import lit.Test
import lit.formats
import lit.util


# name: The name of this test suite.
config.name = 'libc++'
# test_source_root: The root path where tests are located.
config.test_source_root = os.path.dirname(__file__)
config.module_globals = globals()
config.module_paths = [os.path.join(config.test_source_root, 'lit_support')]

# suffixes: A list of file extensions to treat as test files.
config.suffixes = ['.cpp']


lit_config.load_module(config, "LibcxxTestFormat.py")
lit_config.load_module(config, "Env.py")

# Configure extra compiler flags.
include_paths = ['-I' + libcxx_src_root + '/include',
                 '-I' + libcxx_src_root + '/test/support']
library_paths = ['-L' + libcxx_obj_root + '/lib']
compile_flags = []
link_flags    = []
exec_env      = {}


lit_config.load_module(config, "Options.py")
lit_config.load_module(config, "Platform.py")
lit_config.load_module(config, "Triple.py")
lit_config.load_module(config, "ABI.py")
lit_config.load_module(config, "Locale.py")


config.test_format = LibcxxTestFormat(
    cxx_under_test,
    cpp_flags = ['-nostdinc++'] + compile_flags + include_paths,
    ld_flags = ['-nodefaultlibs'] + library_paths + ['-lc++'] + link_flags,
    exec_env = exec_env)

